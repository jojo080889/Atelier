<%= render 'projects/header' %>

<%= render 'projects/body' %>

<% if !(@helpful_crits.nil? || @helpful_crits.count <= 0) %>
<div class="helpful-critiques panel panel-info">
  <div class="panel-heading">
    The user thought the following feedback was helpful for this project:
  </div>
  <div class="panel-body critiques-select">
    <table>
      <% @helpful_crits.each do |crit| %>
        <tr>
          <td class="critique-select">
            <%= truncate(crit.text, length: 50) %>
          </td>
          <td class="critique-link">
            <%= link_to "See full feedback", project_path(crit.project, anchor: "critique_#{crit.id}") %>
          </td>
          <td class="critiquer">
            by <%= link_to crit.user.username, crit.user  %>
            <%= skill_level_badge(crit.user.skill_level) %>
          </td>
        </tr>
      <% end %>
    </table>
  </div>
</div>
<% end %>

<h3><%= pluralize @project.critiques.count, "Feedback" %></h3>

<% if @project.critiques.count <= 0 %>
  <p>
    No feedback yet.
  </p>
<% else %>
  <%= render partial: "critiques/critique", collection: @project.critiques.order(:created_at) %>
<% end %>

<% if current_or_guest_user.id != @project.user.id %>
  <h3>Add Feedback</h3>
<% end %>
<%= render "critiques/form" %>
